import socket

host = '127.0.0.1'  # The server's hostname or IP address
port = 31016      # The port used by the server

if __name__ == '__main__':
    while True:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:  # Create a socket object
            s.bind((host, port))  # Bind to the port
            s.listen()  # Now wait for client connection.
            conn, addr = s.accept()  # Establish connection with client.
            with conn:  # This is for the case when the client is closed and then opened again
                # Print the address of the connected malware
                print('Connected malware by', addr)
                while True:
                    # Receive data from the malware
                    recieved_data = conn.recv(1024)
                    if not recieved_data:  # If there is no data, then break the loop
                        break
                    print(recieved_data)  # Print the received data
                    # Send the received data back to the malware
                    conn.sendall(recieved_data)

